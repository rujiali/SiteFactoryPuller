#!/usr/bin/env php

<?php
if (file_exists(__DIR__ . '/../../../autoload.php')) {
  $root = __DIR__ . '/../../../../';
  require __DIR__ . '/../../../autoload.php';
}
else {
  $root = __DIR__ . '/../';
  require __DIR__ . '/../vendor/autoload.php';
}

use Symfony\Component\Console\Application;
use AppBundle\Commands\PingCommand;
use AppBundle\Commands\CreateBackupCommand;
use AppBundle\Commands\GetLatestBackupURLCommand;
use AppBundle\Commands\ListBackupsCommand;
use AppBundle\Connector\Connector;
use GuzzleHttp\Client;

$application = new Application();
$client = new Client();

$connector = new Connector($root, $client);

$application->add(New PingCommand($connector));
$application->add(New CreateBackupCommand($connector));
$application->add(New ListBackupsCommand($connector));
$application->add(New GetLatestBackupURLCommand($connector));

$application->run();
